import ResponsiveAppBar from '@/components/NavBar.js';
import { app } from '@/firebase.js';
import styles from '@/styles/Home.module.css';
import { Box, Button, TextField } from '@mui/material';
import { getAuth } from 'firebase/auth';
import { Inter } from 'next/font/google';
import Head from 'next/head';
import Image from 'next/image';
import { useRouter } from 'next/router.js';
import { OpenAI } from './api/openai.js';

export default function Home() {
  // chat with AI
  async function onSubmit() {
    const user_prompt = document.getElementById('user-input').value;
    console.log(user_prompt);
    const response = await fetch('./api/openai', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ prompt: user_prompt.toString() }),
    });
    // of type {response: "..."}
    const data = await response.json();
    console.log(data);
  }

  // auth  control
  const auth = getAuth(app);
  console.log(auth);
  const router = useRouter();

  const styles = {
    container: {
      height: '100vh',
      backgroundImage: `url(${'background.jpeg'})`,
      backgroundSize: '100vw',
      backgroundSize: 'cover',
      backgroundRepeat: 'no-repeat',
    },
  };

  return (
    <>
      <Head>
        <title>TheraPal</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main>
        <ResponsiveAppBar />
        <Box sx={styles.container}>
          {auth.currentUser ? (
            <div>
              <TextField
                id="user-input"
                label="Standard"
                variant="standard"
              />
              <Button onClick={onSubmit}>Submit</Button>
            </div>
          ) : (
            <div>Please Sign up!</div>
          )}
        </Box>
      </main>
    </>
  );
}
